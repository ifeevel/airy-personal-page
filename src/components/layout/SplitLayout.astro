---
/**
 * SplitLayout.astro
 * 分栏布局组件 - 用于首页和404页的 Banner + 内容分栏结构
 *
 * 功能：
 * 1. 桌面端：左侧固定 Banner，右侧内容区可滚动
 * 2. 移动端：隐藏 Banner，内容区全屏
 * 3. 支持通过 splitRatio 配置分栏比例
 * 4. 内联关键 CSS 防止首屏布局抖动 (CLS)
 *
 * Props:
 * - splitRatio: number - 左侧 Banner 所占宽度百分比，默认 50%
 *
 * 使用方式：
 * <SplitLayout splitRatio={50}>
 *   <Image slot="banner" src={banner} ... />
 *   <YourContent />
 * </SplitLayout>
 */

import type { BaseLayoutProps as Props } from "@appTypes/site";

const { splitRatio } = Astro.props;
---

<!-- 动态设置分栏比例到 :root，供 footer.css 等全局样式使用 -->
<style is:inline set:html={`:root { --split-ratio: ${splitRatio}%; }`}></style>

<!-- 内联关键 CSS：防止布局抖动 -->
<style is:inline>
    /* 关键布局骨架 - 确保在外部 CSS 加载前骨架已正确渲染 */
    .split-layout {
        position: relative;
    }

    /* 左侧 Banner 区域 - 移动端默认隐藏 */
    .split-layout__banner {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        background-color: var(--bg-body, #ffffff);
        display: none;
        /* Banner 亮度控制，配合主题切换 */
        filter: brightness(var(--banner-brightness, 1));
    }

    /* Banner 图片样式 */
    .split-layout__banner img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: 50% 0;
        display: block;
    }

    /* 右侧内容区域 - 移动端全宽 */
    .split-layout__content {
        width: 100%;
        /* 内容居中 */
        display: flex;
        justify-content: center;
        align-items: center;
        /* 使用 min-height 保证至少满屏，锁定“最小”视口高度，避免抖动 */
        min-height: 100svh;
    }

    /* 内容包装器 */
    .split-layout__inner {
        text-align: center;
        font-weight: 300;
    }

    /* 移动端适配 */
    @media (max-width: 48rem) {
        .split-layout__inner {
            width: 90%;
            margin: 0 auto;
        }
    }

    /* 桌面端：根据 splitRatio 分栏 */
    @media (min-width: 48rem) {
        .split-layout__banner {
            display: block;
            width: var(--split-ratio);
        }
        .split-layout__content {
            /* float 布局 */
            float: right;
            width: calc(100% - var(--split-ratio));
            height: 100vh;
            height: 100dvh;
        }
    }
</style>

<div class="split-layout">
    <!-- 左侧 Banner 区域 -->
    <aside class="split-layout__banner">
        <slot name="banner" />
    </aside>

    <!-- 右侧内容区域 -->
    <main class="split-layout__content">
        <div class="split-layout__inner">
            <slot />
        </div>
    </main>
</div>
